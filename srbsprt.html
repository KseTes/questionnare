<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow">
  <link rel="icon" type="image/x-icon" href="/questionnare/favicon.ico">
  <title>Questionnaire</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      padding: 0;  
      background-color: #e0e0e0;
      font-family: Arial, sans-serif;
      font-size: 20px;
      color: #000;
    }
    .wrapper {
      max-width: 25em;
      padding: 0.5em;
    }
    .question {
      margin-bottom: 2em;
      padding: 1.5em 3em;
      background-color: #555;
      color: #fff;
    }
    .buttons {
      display: flex;
      gap: 1.3em;
      justify-content: center;
      flex-direction: column;
      width: 100%;
      flex-wrap: wrap;
    }
    .question, .button {
      border-radius: 1.5em;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    .button {
      padding: 1.5em 3em;
      cursor: pointer;
      transition: transform 0.1s;
      text-decoration: none;
      background-color: #fff;
      color: #111;
      flex: 1 1 0;
    }
    .button:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <section class="wrapper">
    <div class="question" id="question">Do you play casino online?</div>
    <div class="buttons">
      <a href="#" class="button" id="yesBtn">YES</a>
      <a href="#" class="button" id="maybeBtn">NO but maybe will start one day</a>
      <a href="#" class="button" id="noBtn">NO and most likely will never start</a>
    </div>
  </section>

  <script>
    const CONFIG = {
      ridKey: 'RID',
      regionKey: 'region',
      collectEndpoint: 'https://ksetes.bpdev.ru/api/v1/collect',
      fallbackLink: 'https://samplicio.us/s/ClientCallBack.aspx?RIS=20'
    };

    const translations = {
       et: {
        defaultLang: 'am',
        links: {
          yesLink: "https://yandex.ru/poll/WhuXLpxkdtKFs6AvYg7AaM",
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "We are conducting a study on digital gambling. Do you play online casino games?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          am: {
            question: "ዲጂታል ቁማር ላይ ጥናት እያካሄድን ነው። የመስመር ላይ ካዚኖ ጨዋታዎችን ትጫወታለህ/ትጫወቻለሽ?",
            yes: "አዎ",
            maybe: "አይደለም፣ ግን ምናልባት አንድ ቀን እጀምራለሁ/እጀምራለሽ",
            no: "አይደለም፣ እና ምናልባት በጣም አልጀምርም/አልጀምርሽም"
          }          
        }
      },
      ru: {
        defaultLang: 'ru',
        links: {
          yesLink: "https://yandex.ru/poll/HEnUUM22RXYzxNHtf4nq89",
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          ru: {
            question: "Мы проводим исследование в области цифрового гемблинга. Играете ли вы в онлайн-казино?",
            yes: "ДА",
            maybe: "НЕТ, но, возможно, когда-нибудь начну",
            no: "НЕТ и, скорее всего, никогда не начну"
          }
        }
      },
      sl: {
        defaultLang: 'si',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          si: {
            question: "ඔබ මාර්ගගත කැසිනෝ ක්‍රීඩා කරනවාද?",
            yes: "ඔව්",
            maybe: "කිසිදා ක්‍රීඩා කර නැත. එනමුත් යම් දිනක ක්‍රීඩා කිරීම ආරම්භ කිරීමට ඉඩ ඇත",
            no: "කිසිදා ක්‍රීඩා කර නැත. කිසිදු දිනක ක්‍රීඩා කිරීම ආරම්භ නොකරනු ඇත"
          }          
        }
      },
      eg: {
        defaultLang: 'ar',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          ar: {
            question: "هل تلعب ألعاب الكازينو على الإنترنت؟",
            yes: "نعم",
            maybe: "أبدًا، لكن ربما سأبدأ اللعب يوماً ما",
            no: "أبدًا، وعلى الأرجح لن أبدأ اللعب أبدًا"
          }          
        }
      },
      mn: {
        defaultLang: 'my',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          my: {
            question: "အွန်လိုင်းကာစီနိုကစားပါသလား။",
            yes: "ဟုတ်သည်။",
            maybe: "မည်သည့်အခါမျှ။ သို့သော် တစ်နေ့နေ့တွင် စတင်ကစားနိုင်ပါသည်။",
            no: "မည်သည့်အခါမျှ။ ထို့အပြင် စတင်ကစားမည့် အလားအလာ သိပ်မရှိပါ။"
          }          
        }
      },
      tr: {
        defaultLang: 'tr',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          tr: {
            question: "Çevrimiçi casino oyunları oynuyor musunuz?",
            yes: "EVET",
            maybe: "Asla ama belki bir gün oynarım",
            no: "Asla ve büyük olasılıkla da asla oynamam"
          }          
        }
      },
      th: {
        defaultLang: 'th',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          th: {
            question: "คุณเล่นคาสิโนออนไลน์หรือเปล่า?",
            yes: "ใช่",
            maybe: "ไม่เคย แต่บางทีอาจจะเริ่มเล่นสักวันก็ได้",
            no: "ไม่เคย และมีแนวโน้มว่าจะไม่เริ่มเล่น"
          }          
        }
      },
      ind: {
        defaultLang: 'id',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          id: {
            question: "Apakah Anda bermain kasino daring?",
            yes: "YA",
            maybe: "Tidak pernah. Tapi mungkin saya akan mulai bermain suatu hari nanti",
            no: "Tidak pernah. Dan kemungkinan besar tidak akan pernah mulai bermain"
          }          
        }
      },
      bg: {
        defaultLang: 'bn',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          bn: {
            question: "তুমি কি অনলাইন ক্যাসিনো খেলে?",
            yes: "হ্যাঁ",
            maybe: "কখনোই না। তবে হয়তো কোনো একদিন খেলা শুরু করব",
            no: "কখনোই না। এবং সম্ভবত কখনোই খেলা শুরু করব না"
          }          
        }
      },
      uz: {
        defaultLang: 'uz',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          ru: {
            question: "Играете ли вы в онлайн-казино?",
            yes: "ДА",
            maybe: "НЕТ, но, возможно, когда-нибудь начну",
            no: "НЕТ и, скорее всего, никогда не начну"
          },
          uz: {
            question: "Siz onlayn kazino o'ynaysizmi?",
            yes: "HA",
            maybe: "Hech qachon. Lekin, ehtimol, bir kun o'ynashni boshlaydi",
            no: "Hech qachon. Va, ehtimol, hech qachon o'ynashni boshlamaydi"
          }          
        }
      },
      pa: {
        defaultLang: 'pa',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          pa: {
            question: "کیا آپ آن لائن کیسینو کھیلتے ہیں؟",
            yes: "جی ہاں",
            maybe: "کبھی نہیں۔ لیکن شاید ایک دن کھیلنا شروع کر دوں",
            no: "کبھی نہیں۔ اور زیادہ امکان ہے کہ کبھی کھیلنا شروع نہ کروں گا"
          }          
        }
      },
      ma: {
        defaultLang: 'ms',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          ms: {
            question: "Adakah anda bermain kasino dalam talian?",
            yes: "YA",
            maybe: "Tidak pernah. Tetapi, mungkin akan mula bermain suatu hari nanti",
            no: "Tidak pernah. Dan kemungkinan besar tidak akan mula bermain"
          }          
        }
      },
      ir: {
        defaultLang: 'ar',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          ar: {
            question: "هل تلعب كازينو على الإنترنت؟",
            yes: "نعم",
            maybe: "أبدًا. ولكن ربما سأبدأ اللعب يومًا ما.",
            no: "أبدًا. وعلى الأرجح لن أبدأ اللعب أبدًا."
          }          
        }
      },
      hk: {
        defaultLang: 'zh',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          zh: {
            question: "你玩在线赌场吗？",
            yes: "是的",
            maybe: "从不。但也许有一天会开始玩。",
            no: "从不。而且很可能永远不会开始玩。"
          }          
        }
      },
      jp: {
        defaultLang: 'ja',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          ja: {
            question: "オンラインカジノはプレイしますか？",
            yes: "はい",
            maybe: "一度もプレイしたことがありません。でも、いつか始めるかもしれません。",
            no: "一度もプレイしたことがありません。おそらく一生プレイしないでしょう。"
          }          
        }
      },
      ko: {
        defaultLang: 'ko',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          ko: {
            question: "온라인 카지노를 하시나요?",
            yes: "네",
            maybe: "전혀 안 하세요. 하지만 언젠가는 시작하게 될지도 몰라요",
            no: "절대 안 하세요. 그리고 아마 시작하지도 않을 거예요"
          }          
        }
      },
      pr: {
        defaultLang: 'pt',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          pt: {
            question: "Você joga em casinos online?",
            yes: "SIM",
            maybe: "Nunca. Mas talvez comece a jogar um dia",
            no: "Nunca. E provavelmente nunca começará a jogar."
          }          
        }
      },
      in: {
        defaultLang: 'hi',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          hi: {
            question: "क्या आप ऑनलाइन कैसीनो खेलते हैं?",
            yes: "हाँ",
            maybe: "कभी नहीं। लेकिन शायद एक दिन खेलना शुरू कर देंगे।",
            no: "कभी नहीं। और शायद कभी खेलना शुरू भी नहीं करेंगे।"
          }          
        }
      },
      br: {
        defaultLang: 'pt',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          pt: {
            question: "Você joga em cassinos online?",
            yes: "SIM",
            maybe: "Nunca. Mas talvez comece a jogar um dia",
            no: "Nunca. E provavelmente nunca começará a jogar"
          }          
        }
      },
      ph: {
        defaultLang: 'fil',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          fil: {
            question: "Naglalaro ka ba ng casino online?",
            yes: "OO",
            maybe: "Hindi kailanman. Pero baka isang araw ay magsisimula na akong maglaro",
            no: "Hindi kailanman. At malamang ay hindi kailanman magsisimulang maglaro"
          }          
        }
      },
      ch: {
        defaultLang: 'es',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          es: {
            question: "¿Juegas al casino en línea?",
            yes: "Sí",
            maybe: "Nunca. Pero quizás empiece a jugar algún día",
            no: "Nunca. Y lo más probable es que nunca empiece a jugar"
          }          
        }
      },
      mx: {
        defaultLang: 'es',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          es: {
            question: "¿Juegas al casino en línea?",
            yes: "Sí",
            maybe: "Nunca. Pero quizás empiece a jugar algún día",
            no: "Nunca. Y lo más probable es que nunca empiece a jugar"
          }          
        }
      },
      mr: {
        defaultLang: 'fr',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          fr: {
            question: "Jouez-vous au casino en ligne ?",
            yes: "Oui",
            maybe: "Jamais, mais peut-être que je commencerai à jouer un jour",
            no: "Jamais, et il est fort probable que je ne commencerai jamais à jouer"
          }
        }
      },
      cd: {
        defaultLang: 'fr',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          fr: {
            question: "Jouez-vous au casino en ligne ?",
            yes: "Oui",
            maybe: "Jamais, mais peut-être que je commencerai à jouer un jour",
            no: "Jamais, et il est fort probable que je ne commencerai jamais à jouer"
          }
        }
      },
      ar: {
        defaultLang: 'es',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          es: {
            question: "¿Juegas al casino en línea?",
            yes: "Sí",
            maybe: "Nunca. Pero quizás empiece a jugar algún día",
            no: "Nunca. Y lo más probable es que nunca empiece a jugar"
          }          
        }
      },
      ca: {
        defaultLang: 'fr',
        links: {
          yesLink: CONFIG.fallbackLink,
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "Do you play casino online?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          },
          fr: {
            question: "Jouez-vous au casino en ligne ?",
            yes: "Oui",
            maybe: "Jamais, mais peut-être que je commencerai à jouer un jour",
            no: "Jamais, et il est fort probable que je ne commencerai jamais à jouer"
          }
        }
      },
      ni: {
        defaultLang: 'en',
        links: {
          yesLink: "https://yandex.ru/poll/ULPY3PDnQwCg7X13rok776",
          maybeLink: CONFIG.fallbackLink,
          noLink: CONFIG.fallbackLink
        },
        languages: {
          en: {
            question: "We are conducting a study on digital gambling. Do you play online casino games?",
            yes: "YES",
            maybe: "NO but maybe will start one day",
            no: "NO and most likely will never start"
          }
        }
      }
    };

    const availableRegionCodes = Object.keys(translations);

    async function sendEventToCollector(eventType, eventData = {}) {
      try {
          const payload = {
              event: eventType,
              timestamp: new Date().toISOString(),
              url: window.location.href,
              userAgent: navigator.userAgent,
              ...eventData
          };

          const params = new URLSearchParams(payload).toString();
          const fullUrl = `${CONFIG.collectEndpoint}?${params}`;
          const response = await fetch(fullUrl, {
              method: 'GET',
              referrerPolicy: 'no-referrer-when-downgrade',
              signal: AbortSignal.timeout(5000)
          });

          if (response.status !== 204) {
              console.warn(`Collector responded with unexpected status: ${response.status}`);
          }

          console.debug('Event sent successfully to collector:', payload.event);

      } catch (error) {
          if (error.name === 'AbortError') {
            console.warn('Collector request timed out.');
          } else if (error.name === 'TypeError' && error.message.includes('fetch')) {
            console.warn('Network error or CORS issue when sending event:', error.message);
          } else {
            console.warn('Failed to send event to collector:', error.message);
          }
      }
    }

    function getRidValue() {
        let ridValue = null;
        try {
            const params = new URLSearchParams(window.location.search);
            for (const [key, value] of params.entries()) {
                if (key.toLowerCase() === CONFIG.ridKey.toLowerCase()) {
                    ridValue = value.trim();
                    break;
                }
            }
        } catch (error) {
            console.error('Failed to parse URL parameters for RID:', error);
        }

        if (!ridValue && isLocalStorageAvailable()) {
            ridValue = localStorage.getItem(CONFIG.ridKey);
        }

        return ridValue && /^[a-zA-Z0-9_-]+$/.test(ridValue) ? ridValue : null;
    }

    function updateContent(region, lang) {
        try {
            const questionEl = document.getElementById('question');
            const buttons = [
                document.getElementById('yesBtn'),
                document.getElementById('maybeBtn'), 
                document.getElementById('noBtn')
            ];
            
            if (!questionEl || buttons.some(btn => !btn)) {
                throw new Error('One or more elements not found in the DOM');
            }

            const regionData = translations[region];
            if (!regionData) {
                throw new Error(`No data found for region: ${region}`);
            }

            const langData = regionData.languages[lang];
            const messages = langData || regionData.languages[regionData.defaultLang];

            questionEl.textContent = messages.question;
            
            const keys = ['yes', 'maybe', 'no'];
            const buttonIds = ['yesBtn', 'maybeBtn', 'noBtn'];
            buttons.forEach((button, index) => {
                button.textContent = messages[keys[index]];
                button.removeAttribute('href');
                button.onclick = function(e) {
                    e.preventDefault();
                    const clickedButtonId = buttonIds[index]; // 'yesBtn', 'maybeBtn', 'noBtn'
                    const actionLabel = keys[index]; // 'yes', 'maybe', 'no'

                    const rid = getRidValue();
                    sendEventToCollector('button_click', {
                        button_id: clickedButtonId,
                        action: actionLabel,
                        rid: rid,
                        lang: lang
                    });

                    const fallbackUrl = new URL(regionData.links[`${actionLabel}Link`]);
                    if (rid) {
                        fallbackUrl.searchParams.set(CONFIG.ridKey, rid);
                    }
                    setTimeout(() => {
                        window.location.href = fallbackUrl.toString();
                    }, 100);
                };
            });
        } catch (error) {
            console.error('Failed to update content:', error);
        }
    }

    function addRidParam(link, ridValue) {
        if (!link || !ridValue) return;
        try {
            const linkUrl = new URL(link.href);
            linkUrl.searchParams.set(CONFIG.ridKey, ridValue);
            link.href = linkUrl.toString();
        } catch (error) {
            console.error('Failed to add RID to link:', error);
        }
    }

    function isValidRid(ridValue) {
        return ridValue && /^[a-zA-Z0-9_-]+$/.test(ridValue);
    }
    
    function getParameterFromUrl(paramKey) {
        try {
            const params = new URLSearchParams(window.location.search);
            for (const [key, value] of params.entries()) {
                if (key.toLowerCase() === paramKey.toLowerCase()) {
                    return value.trim();
                }
            }
            return null;
        } catch (error) {
            console.error('Failed to parse URL parameters:', error);
            return null;
        }
    }

    function isLocalStorageAvailable() {
        try {
            const storage = window.localStorage;
            const test = '__storage_test__';
            storage.setItem(test, test);
            storage.removeItem(test);
            return true;
        } catch {
            return false;
        }
    }

    function getBrowserLanguage(region) {
        const regionData = translations[region];
        if (!regionData) return regionData.defaultLang;

        const browserLangs = navigator.languages || [navigator.language];
        
        for (const lang of browserLangs) {
            const primaryLang = lang.split('-')[0].toLowerCase();
            if (primaryLang in regionData.languages) {
                return primaryLang;
            }
            if (lang.toLowerCase() in regionData.languages) {
                return lang.toLowerCase();
            }
        }
        return regionData.defaultLang;
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        try {
            const requestedRegion = getParameterFromUrl(CONFIG.regionKey);
            
            if (!requestedRegion || !availableRegionCodes.includes(requestedRegion)) {
                sendEventToCollector('validation_error', {
                  error_type: 'invalid_or_missing_region',
                  requested_region: requestedRegion,
                  url: window.location.href,
                  userAgent: navigator.userAgent
                });
                
                window.location.replace('./406.html?req=' + encodeURIComponent(window.location.href));
                return;
            }

            const detectedLang = getBrowserLanguage(requestedRegion);

            const ridOnLoad = getRidValue();
            sendEventToCollector('page_view', { rid: ridOnLoad, region: requestedRegion, lang: detectedLang });

            updateContent(requestedRegion, detectedLang);

            const ridValue = getParameterFromUrl(CONFIG.ridKey);
            if (ridValue) {
                if (isLocalStorageAvailable()) {
                    localStorage.setItem('RID', ridValue);
                }

                document.querySelectorAll('.button').forEach(btn => addRidParam(btn, ridValue));
            }
        } catch (error) {
            console.error('Initialization failed:', error);
        }
    });
  </script>
</body>
</html>










